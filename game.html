<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Doll Catch Game</title>
<style>
  * {
    box-sizing: border-box;
  }
  body, html {
    margin: 0; padding: 0; height: 100vh; overflow: hidden;
    font-family: Arial, sans-serif;
    user-select: none;
  }
  #gameArea {
    position: relative;
    width: 100vw;
    height: 100vh;
    overflow: hidden;
    background: linear-gradient(to bottom, #87ceeb 0%, #b0e0e6 70%, #ffffff 100%);
  }
  #gameArea::before {
    content: '';
    position: absolute;
    top: 10%;
    left: 0;
    width: 100%;
    height: 20%;
    background: radial-gradient(circle at 20% 50%, #fff 20%, transparent 70%),
                radial-gradient(circle at 50% 40%, #fff 15%, transparent 60%),
                radial-gradient(circle at 80% 60%, #fff 25%, transparent 75%);
    opacity: 0.25;
    pointer-events: none;
    z-index: 0;
  }
  #scoreBoard {
    position: fixed;
    top: 10px;
    left: 10px;
    font-size: 28px;
    font-weight: bold;
    color: #004d40;
    text-shadow: 1px 1px 3px #00000088;
    z-index: 10;
    transition: color 0.3s ease;
  }
  #scoreBoard.flash {
    color: #d32f2f;
    text-shadow: 0 0 10px #d32f2f;
  }
  #box {
    position: absolute;
    bottom: 20px;
    left: calc(50% - 60px);
    width: 120px;
    height: 60px;
    background: url('box.png') no-repeat center/contain;
    transition: left 0.05s linear;
    z-index: 5;
  }
  .doll {
    position: absolute;
    width: 50px;
    height: 50px;
    pointer-events: none;
    user-select: none;
    background-size: contain;
    background-repeat: no-repeat;
    z-index: 4;
  }
  #congratsMessage {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 48px;
    font-weight: bold;
    color: #4caf50;
    text-shadow: 2px 2px 8px #000000aa;
    background: rgba(255, 255, 255, 0.9);
    padding: 30px 50px;
    border-radius: 15px;
    display: none;
    z-index: 20;
    user-select: none;
  }
</style>
</head>
<body>
  <div id="scoreBoard">Score: 0</div>
  <div id="gameArea">
    <div id="box"></div>
  </div>
  <div id="congratsMessage">ðŸŽ‰ Congratulations! BAILIiiiii... ðŸŽ‰</div>

<script>
  (function(){
    const gameArea = document.getElementById('gameArea');
    const box = document.getElementById('box');
    const scoreBoard = document.getElementById('scoreBoard');
    const congratsMessage = document.getElementById('congratsMessage');

    const boxWidth = 120;
    const boxHeight = 60;

    let gameWidth = window.innerWidth;
    let gameHeight = window.innerHeight;

    let boxX = (gameWidth / 2) - (boxWidth / 2);
    let boxY = gameHeight - boxHeight - 20;

    let speed = 7; // box movement speed in px per frame

    // Dolls config
    const dollCount = 6;
    const dollWidth = 50;
    const dollHeight = 50;
    // Slower falling speed range
    const dollSpeedMin = 0.7;
    const dollSpeedMax = 1.5;

    const dollImages = ['doll1.png','doll2.png','doll3.png','doll4.png','doll5.png'];

    let score = 0;
    let gameOver = false;

    // Create dolls
    let dolls = [];

    for(let i=0; i < dollCount; i++) {
      const doll = document.createElement('div');
      doll.classList.add('doll');
      resetDoll(doll);
      gameArea.appendChild(doll);
      dolls.push({
        el: doll,
        speed: randomSpeed(),
      });
    }

    function randomSpeed() {
      return dollSpeedMin + Math.random() * (dollSpeedMax - dollSpeedMin);
    }

    function resetDoll(doll) {
      // random doll image
      const img = dollImages[Math.floor(Math.random()*dollImages.length)];
      doll.style.backgroundImage = `url(${img})`;

      // random horizontal position within game area
      const maxX = gameWidth - dollWidth;
      const x = Math.floor(Math.random() * maxX);
      doll.style.left = x + 'px';

      // start above the top
      doll.style.top = (-dollHeight - Math.random() * 300) + 'px';
    }

    // Key states
    let keys = {
      left: false,
      right: false
    };

    window.addEventListener('keydown', (e) => {
      if(e.key === 'ArrowLeft' || e.key === 'a' || e.key === 'A') keys.left = true;
      if(e.key === 'ArrowRight' || e.key === 'd' || e.key === 'D') keys.right = true;
    });

    window.addEventListener('keyup', (e) => {
      if(e.key === 'ArrowLeft' || e.key === 'a' || e.key === 'A') keys.left = false;
      if(e.key === 'ArrowRight' || e.key === 'd' || e.key === 'D') keys.right = false;
    });

    // Update box position
    function updateBoxPosition() {
      if(keys.left) {
        boxX -= speed;
        if(boxX < 0) boxX = 0;
      }
      if(keys.right) {
        boxX += speed;
        if(boxX > gameWidth - boxWidth) boxX = gameWidth - boxWidth;
      }
      box.style.left = boxX + 'px';
    }

    // Check collision between doll and box
    function isColliding(dollX, dollY) {
      return !(dollX + dollWidth < boxX ||
               dollX > boxX + boxWidth ||
               dollY + dollHeight < boxY ||
               dollY > boxY + boxHeight);
    }

    // Flash score red when reset
    function flashScore() {
      scoreBoard.classList.add('flash');
      setTimeout(() => scoreBoard.classList.remove('flash'), 300);
    }

    function update() {
      if (gameOver) return;

      updateBoxPosition();

      dolls.forEach(dollObj => {
        let dollEl = dollObj.el;
        let y = parseFloat(dollEl.style.top);
        let x = parseFloat(dollEl.style.left);

        y += dollObj.speed;

        // Check collision with box
        if(isColliding(x, y)) {
          score++;
          scoreBoard.textContent = `Score: ${score}`;
          resetDoll(dollEl);
          dollObj.speed = randomSpeed();

          if(score >= 10) {
            gameOver = true;
            congratsMessage.style.display = 'block';

            // After 10 seconds redirect
            setTimeout(() => {
              window.location.href = 'encouragement.html';
            }, 10000);
          }
          return;
        }

        // If doll falls below the game area, reset score and doll
        if(y > gameHeight) {
          resetDoll(dollEl);
          dollObj.speed = randomSpeed();
          if(score !== 0) {
            score = 0;
            scoreBoard.textContent = `Score: ${score}`;
            flashScore();
          }
          return;
        }

        dollEl.style.top = y + 'px';
      });

      requestAnimationFrame(update);
    }

    // On window resize adjust gameWidth and gameHeight
    window.addEventListener('resize', () => {
      gameWidth = window.innerWidth;
      gameHeight = window.innerHeight;
      if(boxX > gameWidth - boxWidth) {
        boxX = gameWidth - boxWidth;
      }
      box.style.left = boxX + 'px';
    });

    update();
  })();
</script>
</body>
</html>
